!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.dgl=t()}}(function(){return function t(e,r,n){function i(o,u){if(!r[o]){if(!e[o]){var s="function"==typeof require&&require;if(!u&&s)return s(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(t){var r=e[o][1][t];return i(r?r:t)},c,c.exports,t,e,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(t,e,r){r.glMatrix=t("./gl-matrix/common.js"),r.mat2=t("./gl-matrix/mat2.js"),r.mat2d=t("./gl-matrix/mat2d.js"),r.mat3=t("./gl-matrix/mat3.js"),r.mat4=t("./gl-matrix/mat4.js"),r.quat=t("./gl-matrix/quat.js"),r.vec2=t("./gl-matrix/vec2.js"),r.vec3=t("./gl-matrix/vec3.js"),r.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":2,"./gl-matrix/mat2.js":3,"./gl-matrix/mat2d.js":4,"./gl-matrix/mat3.js":5,"./gl-matrix/mat4.js":6,"./gl-matrix/quat.js":7,"./gl-matrix/vec2.js":8,"./gl-matrix/vec3.js":9,"./gl-matrix/vec4.js":10}],2:[function(t,e,r){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.setMatrixArrayType=function(t){GLMAT_ARRAY_TYPE=t};var i=Math.PI/180;n.toRadian=function(t){return t*i},e.exports=n},{}],3:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*a-i*n;return o?(o=1/o,t[0]=a*o,t[1]=-n*o,t[2]=-i*o,t[3]=r*o,t):null},i.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},i.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},i.multiply=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=r[0],s=r[1],l=r[2],c=r[3];return t[0]=n*u+a*s,t[1]=i*u+o*s,t[2]=n*l+a*c,t[3]=i*l+o*c,t},i.mul=i.multiply,i.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+a*u,t[1]=i*s+o*u,t[2]=n*-u+a*s,t[3]=i*-u+o*s,t},i.scale=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=r[0],s=r[1];return t[0]=n*u,t[1]=i*u,t[2]=a*s,t[3]=o*s,t},i.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},i.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},i.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},e.exports=i},{"./common.js":2}],4:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=r*a-n*i;return s?(s=1/s,t[0]=a*s,t[1]=-n*s,t[2]=-i*s,t[3]=r*s,t[4]=(i*u-a*o)*s,t[5]=(n*o-r*u)*s,t):null},i.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},i.multiply=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=r[0],c=r[1],f=r[2],h=r[3],d=r[4],p=r[5];return t[0]=n*l+a*c,t[1]=i*l+o*c,t[2]=n*f+a*h,t[3]=i*f+o*h,t[4]=n*d+a*p+u,t[5]=i*d+o*p+s,t},i.mul=i.multiply,i.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=Math.sin(r),c=Math.cos(r);return t[0]=n*c+a*l,t[1]=i*c+o*l,t[2]=n*-l+a*c,t[3]=i*-l+o*c,t[4]=u,t[5]=s,t},i.scale=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=r[0],c=r[1];return t[0]=n*l,t[1]=i*l,t[2]=a*c,t[3]=o*c,t[4]=u,t[5]=s,t},i.translate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=r[0],c=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=n*l+a*c+u,t[5]=i*l+o*c+s,t},i.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},i.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.exports=i},{"./common.js":2}],5:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},i.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=c*o-u*l,h=-c*a+u*s,d=l*a-o*s,p=r*f+n*h+i*d;return p?(p=1/p,t[0]=f*p,t[1]=(-c*n+i*l)*p,t[2]=(u*n-i*o)*p,t[3]=h*p,t[4]=(c*r-i*s)*p,t[5]=(-u*r+i*a)*p,t[6]=d*p,t[7]=(-l*r+n*s)*p,t[8]=(o*r-n*a)*p,t):null},i.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],c=e[8];return t[0]=o*c-u*l,t[1]=i*l-n*c,t[2]=n*u-i*o,t[3]=u*s-a*c,t[4]=r*c-i*s,t[5]=i*a-r*u,t[6]=a*l-o*s,t[7]=n*s-r*l,t[8]=r*o-n*a,t},i.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],u=t[6],s=t[7],l=t[8];return e*(l*a-o*s)+r*(-l*i+o*u)+n*(s*i-a*u)},i.multiply=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=r[0],d=r[1],p=r[2],v=r[3],m=r[4],y=r[5],b=r[6],_=r[7],g=r[8];return t[0]=h*n+d*o+p*l,t[1]=h*i+d*u+p*c,t[2]=h*a+d*s+p*f,t[3]=v*n+m*o+y*l,t[4]=v*i+m*u+y*c,t[5]=v*a+m*s+y*f,t[6]=b*n+_*o+g*l,t[7]=b*i+_*u+g*c,t[8]=b*a+_*s+g*f,t},i.mul=i.multiply,i.translate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=r[0],d=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=u,t[5]=s,t[6]=h*n+d*o+l,t[7]=h*i+d*u+c,t[8]=h*a+d*s+f,t},i.rotate=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*n+h*o,t[1]=d*i+h*u,t[2]=d*a+h*s,t[3]=d*o-h*n,t[4]=d*u-h*i,t[5]=d*s-h*a,t[6]=l,t[7]=c,t[8]=f,t},i.scale=function(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},i.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},i.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,u=n+n,s=i+i,l=r*o,c=n*o,f=n*u,h=i*o,d=i*u,p=i*s,v=a*o,m=a*u,y=a*s;return t[0]=1-f-p,t[3]=c-y,t[6]=h+m,t[1]=c+y,t[4]=1-l-p,t[7]=d-v,t[2]=h-m,t[5]=d+v,t[8]=1-l-f,t},i.normalFromMat4=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],v=e[13],m=e[14],y=e[15],b=r*u-n*o,_=r*s-i*o,g=r*l-a*o,M=n*s-i*u,E=n*l-a*u,x=i*l-a*s,P=c*v-f*p,w=c*m-h*p,T=c*y-d*p,R=f*m-h*v,O=f*y-d*v,A=h*y-d*m,j=b*A-_*O+g*R+M*T-E*w+x*P;return j?(j=1/j,t[0]=(u*A-s*O+l*R)*j,t[1]=(s*T-o*A-l*w)*j,t[2]=(o*O-u*T+l*P)*j,t[3]=(i*O-n*A-a*R)*j,t[4]=(r*A-i*T+a*w)*j,t[5]=(n*T-r*O-a*P)*j,t[6]=(v*x-m*E+y*M)*j,t[7]=(m*g-p*x-y*_)*j,t[8]=(p*E-v*g+y*b)*j,t):null},i.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.exports=i},{"./common.js":2}],6:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},i.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],v=e[13],m=e[14],y=e[15],b=r*u-n*o,_=r*s-i*o,g=r*l-a*o,M=n*s-i*u,E=n*l-a*u,x=i*l-a*s,P=c*v-f*p,w=c*m-h*p,T=c*y-d*p,R=f*m-h*v,O=f*y-d*v,A=h*y-d*m,j=b*A-_*O+g*R+M*T-E*w+x*P;return j?(j=1/j,t[0]=(u*A-s*O+l*R)*j,t[1]=(i*O-n*A-a*R)*j,t[2]=(v*x-m*E+y*M)*j,t[3]=(h*E-f*x-d*M)*j,t[4]=(s*T-o*A-l*w)*j,t[5]=(r*A-i*T+a*w)*j,t[6]=(m*g-p*x-y*_)*j,t[7]=(c*x-h*g+d*_)*j,t[8]=(o*O-u*T+l*P)*j,t[9]=(n*T-r*O-a*P)*j,t[10]=(p*E-v*g+y*b)*j,t[11]=(f*g-c*E-d*b)*j,t[12]=(u*w-o*R-s*P)*j,t[13]=(r*R-n*w+i*P)*j,t[14]=(v*_-p*M-m*b)*j,t[15]=(c*M-f*_+h*b)*j,t):null},i.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],v=e[13],m=e[14],y=e[15];return t[0]=u*(h*y-d*m)-f*(s*y-l*m)+v*(s*d-l*h),t[1]=-(n*(h*y-d*m)-f*(i*y-a*m)+v*(i*d-a*h)),t[2]=n*(s*y-l*m)-u*(i*y-a*m)+v*(i*l-a*s),t[3]=-(n*(s*d-l*h)-u*(i*d-a*h)+f*(i*l-a*s)),t[4]=-(o*(h*y-d*m)-c*(s*y-l*m)+p*(s*d-l*h)),t[5]=r*(h*y-d*m)-c*(i*y-a*m)+p*(i*d-a*h),t[6]=-(r*(s*y-l*m)-o*(i*y-a*m)+p*(i*l-a*s)),t[7]=r*(s*d-l*h)-o*(i*d-a*h)+c*(i*l-a*s),t[8]=o*(f*y-d*v)-c*(u*y-l*v)+p*(u*d-l*f),t[9]=-(r*(f*y-d*v)-c*(n*y-a*v)+p*(n*d-a*f)),t[10]=r*(u*y-l*v)-o*(n*y-a*v)+p*(n*l-a*u),t[11]=-(r*(u*d-l*f)-o*(n*d-a*f)+c*(n*l-a*u)),t[12]=-(o*(f*m-h*v)-c*(u*m-s*v)+p*(u*h-s*f)),t[13]=r*(f*m-h*v)-c*(n*m-i*v)+p*(n*h-i*f),t[14]=-(r*(u*m-s*v)-o*(n*m-i*v)+p*(n*s-i*u)),t[15]=r*(u*h-s*f)-o*(n*h-i*f)+c*(n*s-i*u),t},i.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],u=t[6],s=t[7],l=t[8],c=t[9],f=t[10],h=t[11],d=t[12],p=t[13],v=t[14],m=t[15],y=e*o-r*a,b=e*u-n*a,_=e*s-i*a,g=r*u-n*o,M=r*s-i*o,E=n*s-i*u,x=l*p-c*d,P=l*v-f*d,w=l*m-h*d,T=c*v-f*p,R=c*m-h*p,O=f*m-h*v;return y*O-b*R+_*T+g*w-M*P+E*x},i.multiply=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=e[9],d=e[10],p=e[11],v=e[12],m=e[13],y=e[14],b=e[15],_=r[0],g=r[1],M=r[2],E=r[3];return t[0]=_*n+g*u+M*f+E*v,t[1]=_*i+g*s+M*h+E*m,t[2]=_*a+g*l+M*d+E*y,t[3]=_*o+g*c+M*p+E*b,_=r[4],g=r[5],M=r[6],E=r[7],t[4]=_*n+g*u+M*f+E*v,t[5]=_*i+g*s+M*h+E*m,t[6]=_*a+g*l+M*d+E*y,t[7]=_*o+g*c+M*p+E*b,_=r[8],g=r[9],M=r[10],E=r[11],t[8]=_*n+g*u+M*f+E*v,t[9]=_*i+g*s+M*h+E*m,t[10]=_*a+g*l+M*d+E*y,t[11]=_*o+g*c+M*p+E*b,_=r[12],g=r[13],M=r[14],E=r[15],t[12]=_*n+g*u+M*f+E*v,t[13]=_*i+g*s+M*h+E*m,t[14]=_*a+g*l+M*d+E*y,t[15]=_*o+g*c+M*p+E*b,t},i.mul=i.multiply,i.translate=function(t,e,r){var n,i,a,o,u,s,l,c,f,h,d,p,v=r[0],m=r[1],y=r[2];return e===t?(t[12]=e[0]*v+e[4]*m+e[8]*y+e[12],t[13]=e[1]*v+e[5]*m+e[9]*y+e[13],t[14]=e[2]*v+e[6]*m+e[10]*y+e[14],t[15]=e[3]*v+e[7]*m+e[11]*y+e[15]):(n=e[0],i=e[1],a=e[2],o=e[3],u=e[4],s=e[5],l=e[6],c=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=u,t[5]=s,t[6]=l,t[7]=c,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=n*v+u*m+f*y+e[12],t[13]=i*v+s*m+h*y+e[13],t[14]=a*v+l*m+d*y+e[14],t[15]=o*v+c*m+p*y+e[15]),t},i.scale=function(t,e,r){var n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.rotate=function(t,e,r,i){var a,o,u,s,l,c,f,h,d,p,v,m,y,b,_,g,M,E,x,P,w,T,R,O,A=i[0],j=i[1],C=i[2],S=Math.sqrt(A*A+j*j+C*C);return Math.abs(S)<n.EPSILON?null:(S=1/S,A*=S,j*=S,C*=S,a=Math.sin(r),o=Math.cos(r),u=1-o,s=e[0],l=e[1],c=e[2],f=e[3],h=e[4],d=e[5],p=e[6],v=e[7],m=e[8],y=e[9],b=e[10],_=e[11],g=A*A*u+o,M=j*A*u+C*a,E=C*A*u-j*a,x=A*j*u-C*a,P=j*j*u+o,w=C*j*u+A*a,T=A*C*u+j*a,R=j*C*u-A*a,O=C*C*u+o,t[0]=s*g+h*M+m*E,t[1]=l*g+d*M+y*E,t[2]=c*g+p*M+b*E,t[3]=f*g+v*M+_*E,t[4]=s*x+h*P+m*w,t[5]=l*x+d*P+y*w,t[6]=c*x+p*P+b*w,t[7]=f*x+v*P+_*w,t[8]=s*T+h*R+m*O,t[9]=l*T+d*R+y*O,t[10]=c*T+p*R+b*O,t[11]=f*T+v*R+_*O,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},i.rotateX=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[4],o=e[5],u=e[6],s=e[7],l=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+l*n,t[5]=o*i+c*n,t[6]=u*i+f*n,t[7]=s*i+h*n,t[8]=l*i-a*n,t[9]=c*i-o*n,t[10]=f*i-u*n,t[11]=h*i-s*n,t},i.rotateY=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],u=e[2],s=e[3],l=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-l*n,t[1]=o*i-c*n,t[2]=u*i-f*n,t[3]=s*i-h*n,t[8]=a*n+l*i,t[9]=o*n+c*i,t[10]=u*n+f*i,t[11]=s*n+h*i,t},i.rotateZ=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],u=e[2],s=e[3],l=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+l*n,t[1]=o*i+c*n,t[2]=u*i+f*n,t[3]=s*i+h*n,t[4]=l*i-a*n,t[5]=c*i-o*n,t[6]=f*i-u*n,t[7]=h*i-s*n,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotation=function(t,e,r){var i,a,o,u=r[0],s=r[1],l=r[2],c=Math.sqrt(u*u+s*s+l*l);return Math.abs(c)<n.EPSILON?null:(c=1/c,u*=c,s*=c,l*=c,i=Math.sin(e),a=Math.cos(e),o=1-a,t[0]=u*u*o+a,t[1]=s*u*o+l*i,t[2]=l*u*o-s*i,t[3]=0,t[4]=u*s*o-l*i,t[5]=s*s*o+a,t[6]=l*s*o+u*i,t[7]=0,t[8]=u*l*o+s*i,t[9]=s*l*o-u*i,t[10]=l*l*o+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},i.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotationTranslation=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=n+n,s=i+i,l=a+a,c=n*u,f=n*s,h=n*l,d=i*s,p=i*l,v=a*l,m=o*u,y=o*s,b=o*l;return t[0]=1-(d+v),t[1]=f+b,t[2]=h-y,t[3]=0,t[4]=f-b,t[5]=1-(c+v),t[6]=p+m,t[7]=0,t[8]=h+y,t[9]=p-m,t[10]=1-(c+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},i.fromRotationTranslationScale=function(t,e,r,n){var i=e[0],a=e[1],o=e[2],u=e[3],s=i+i,l=a+a,c=o+o,f=i*s,h=i*l,d=i*c,p=a*l,v=a*c,m=o*c,y=u*s,b=u*l,_=u*c,g=n[0],M=n[1],E=n[2];return t[0]=(1-(p+m))*g,t[1]=(h+_)*g,t[2]=(d-b)*g,t[3]=0,t[4]=(h-_)*M,t[5]=(1-(f+m))*M,t[6]=(v+y)*M,t[7]=0,t[8]=(d+b)*E,t[9]=(v-y)*E,t[10]=(1-(f+p))*E,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},i.fromRotationTranslationScaleOrigin=function(t,e,r,n,i){var a=e[0],o=e[1],u=e[2],s=e[3],l=a+a,c=o+o,f=u+u,h=a*l,d=a*c,p=a*f,v=o*c,m=o*f,y=u*f,b=s*l,_=s*c,g=s*f,M=n[0],E=n[1],x=n[2],P=i[0],w=i[1],T=i[2];return t[0]=(1-(v+y))*M,t[1]=(d+g)*M,t[2]=(p-_)*M,t[3]=0,t[4]=(d-g)*E,t[5]=(1-(h+y))*E,t[6]=(m+b)*E,t[7]=0,t[8]=(p+_)*x,t[9]=(m-b)*x,t[10]=(1-(h+v))*x,t[11]=0,t[12]=r[0]+P-(t[0]*P+t[4]*w+t[8]*T),t[13]=r[1]+w-(t[1]*P+t[5]*w+t[9]*T),t[14]=r[2]+T-(t[2]*P+t[6]*w+t[10]*T),t[15]=1,t},i.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,u=n+n,s=i+i,l=r*o,c=n*o,f=n*u,h=i*o,d=i*u,p=i*s,v=a*o,m=a*u,y=a*s;return t[0]=1-f-p,t[1]=c+y,t[2]=h-m,t[3]=0,t[4]=c-y,t[5]=1-l-p,t[6]=d+v,t[7]=0,t[8]=h+m,t[9]=d-v,t[10]=1-l-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.frustum=function(t,e,r,n,i,a,o){var u=1/(r-e),s=1/(i-n),l=1/(a-o);return t[0]=2*a*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*s,t[6]=0,t[7]=0,t[8]=(r+e)*u,t[9]=(i+n)*s,t[10]=(o+a)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*l,t[15]=0,t},i.perspective=function(t,e,r,n,i){var a=1/Math.tan(e/2),o=1/(n-i);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*o,t[15]=0,t},i.perspectiveFromFieldOfView=function(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(o+u),l=2/(i+a);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-((o-u)*s*.5),t[9]=(i-a)*l*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},i.ortho=function(t,e,r,n,i,a,o){var u=1/(e-r),s=1/(n-i),l=1/(a-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+r)*u,t[13]=(i+n)*s,t[14]=(o+a)*l,t[15]=1,t},i.lookAt=function(t,e,r,a){var o,u,s,l,c,f,h,d,p,v,m=e[0],y=e[1],b=e[2],_=a[0],g=a[1],M=a[2],E=r[0],x=r[1],P=r[2];return Math.abs(m-E)<n.EPSILON&&Math.abs(y-x)<n.EPSILON&&Math.abs(b-P)<n.EPSILON?i.identity(t):(h=m-E,d=y-x,p=b-P,v=1/Math.sqrt(h*h+d*d+p*p),h*=v,d*=v,p*=v,o=g*p-M*d,u=M*h-_*p,s=_*d-g*h,v=Math.sqrt(o*o+u*u+s*s),v?(v=1/v,o*=v,u*=v,s*=v):(o=0,u=0,s=0),l=d*s-p*u,c=p*o-h*s,f=h*u-d*o,v=Math.sqrt(l*l+c*c+f*f),v?(v=1/v,l*=v,c*=v,f*=v):(l=0,c=0,f=0),t[0]=o,t[1]=l,t[2]=h,t[3]=0,t[4]=u,t[5]=c,t[6]=d,t[7]=0,t[8]=s,t[9]=f,t[10]=p,t[11]=0,t[12]=-(o*m+u*y+s*b),t[13]=-(l*m+c*y+f*b),t[14]=-(h*m+d*y+p*b),t[15]=1,t)},i.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.exports=i},{"./common.js":2}],7:[function(t,e,r){var n=t("./common.js"),i=t("./mat3.js"),a=t("./vec3.js"),o=t("./vec4.js"),u={};u.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.rotationTo=function(){var t=a.create(),e=a.fromValues(1,0,0),r=a.fromValues(0,1,0);return function(n,i,o){var s=a.dot(i,o);return-.999999>s?(a.cross(t,e,i),a.length(t)<1e-6&&a.cross(t,r,i),a.normalize(t,t),u.setAxisAngle(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(a.cross(t,i,o),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,u.normalize(n,n))}}(),u.setAxes=function(){var t=i.create();return function(e,r,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],u.normalize(e,u.fromMat3(e,t))}}(),u.clone=o.clone,u.fromValues=o.fromValues,u.copy=o.copy,u.set=o.set,u.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},u.setAxisAngle=function(t,e,r){r=.5*r;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t},u.add=o.add,u.multiply=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],u=r[0],s=r[1],l=r[2],c=r[3];return t[0]=n*c+o*u+i*l-a*s,t[1]=i*c+o*s+a*u-n*l,t[2]=a*c+o*l+n*s-i*u,t[3]=o*c-n*u-i*s-a*l,t},u.mul=u.multiply,u.scale=o.scale,u.rotateX=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+o*u,t[1]=i*s+a*u,t[2]=a*s-i*u,t[3]=o*s-n*u,t},u.rotateY=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s-a*u,t[1]=i*s+o*u,t[2]=a*s+n*u,t[3]=o*s-i*u,t},u.rotateZ=function(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+i*u,t[1]=i*s-n*u,t[2]=a*s+o*u,t[3]=o*s-a*u,t},u.calculateW=function(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t},u.dot=o.dot,u.lerp=o.lerp,u.slerp=function(t,e,r,n){var i,a,o,u,s,l=e[0],c=e[1],f=e[2],h=e[3],d=r[0],p=r[1],v=r[2],m=r[3];return a=l*d+c*p+f*v+h*m,0>a&&(a=-a,d=-d,p=-p,v=-v,m=-m),1-a>1e-6?(i=Math.acos(a),o=Math.sin(i),u=Math.sin((1-n)*i)/o,s=Math.sin(n*i)/o):(u=1-n,s=n),t[0]=u*l+s*d,t[1]=u*c+s*p,t[2]=u*f+s*v,t[3]=u*h+s*m,t},u.sqlerp=function(){var t=u.create(),e=u.create();return function(r,n,i,a,o,s){return u.slerp(t,n,o,s),u.slerp(e,i,a,s),u.slerp(r,t,e,2*s*(1-s)),r}}(),u.invert=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a,u=o?1/o:0;return t[0]=-r*u,t[1]=-n*u,t[2]=-i*u,t[3]=a*u,t},u.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},u.length=o.length,u.len=u.length,u.squaredLength=o.squaredLength,u.sqrLen=u.squaredLength,u.normalize=o.normalize,u.fromMat3=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*o+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*a+o]-e[3*o+a])*r,t[a]=(e[3*a+i]+e[3*i+a])*r,t[o]=(e[3*o+i]+e[3*i+o])*r}return t},u.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=u},{"./common.js":2,"./mat3.js":5,"./vec3.js":9,"./vec4.js":10}],8:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},i.fromValues=function(t,e){var r=new n.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},i.set=function(t,e,r){return t[0]=e,t[1]=r,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},i.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},i.lerp=function(t,e,r,n){var i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t},i.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},i.transformMat2=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t},i.transformMat2d=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t},i.transformMat3=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,a,o){var u,s;for(r||(r=2),n||(n=0),s=i?Math.min(i*r+n,e.length):e.length,u=n;s>u;u+=r)t[0]=e[u],t[1]=e[u+1],a(t,t,o),e[u]=t[0],e[u+1]=t[1];return e}}(),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exports=i},{"./common.js":2}],9:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.fromValues=function(t,e,r){var i=new n.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=r,i},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.cross=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],u=r[1],s=r[2];return t[0]=i*s-a*u,t[1]=a*o-n*s,t[2]=n*u-i*o,t},i.lerp=function(t,e,r,n){var i=e[0],a=e[1],o=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t},i.hermite=function(t,e,r,n,i,a){var o=a*a,u=o*(2*a-3)+1,s=o*(a-2)+a,l=o*(a-1),c=o*(3-2*a);return t[0]=e[0]*u+r[0]*s+n[0]*l+i[0]*c,t[1]=e[1]*u+r[1]*s+n[1]*l+i[1]*c,t[2]=e[2]*u+r[2]*s+n[2]*l+i[2]*c,t},i.bezier=function(t,e,r,n,i,a){var o=1-a,u=o*o,s=a*a,l=u*o,c=3*a*u,f=3*s*o,h=s*a;return t[0]=e[0]*l+r[0]*c+n[0]*f+i[0]*h,t[1]=e[1]*l+r[1]*c+n[1]*f+i[1]*h,t[2]=e[2]*l+r[2]*c+n[2]*f+i[2]*h,t},i.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI,i=2*n.RANDOM()-1,a=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=i*e,t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,t},i.transformMat3=function(t,e,r){var n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t},i.transformQuat=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],u=r[1],s=r[2],l=r[3],c=l*n+u*a-s*i,f=l*i+s*n-o*a,h=l*a+o*i-u*n,d=-o*n-u*i-s*a;return t[0]=c*l+d*-o+f*-s-h*-u,t[1]=f*l+d*-u+h*-o-c*-s,t[2]=h*l+d*-s+c*-u-f*-o,t},i.rotateX=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},i.rotateY=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},i.rotateZ=function(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,a,o){var u,s;for(r||(r=3),n||(n=0),s=i?Math.min(i*r+n,e.length):e.length,u=n;s>u;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],a(t,t,o),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}(),i.angle=function(t,e){var r=i.fromValues(t[0],t[1],t[2]),n=i.fromValues(e[0],e[1],e[2]);i.normalize(r,r),i.normalize(n,n);var a=i.dot(r,n);return a>1?0:Math.acos(a)},i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exports=i},{"./common.js":2}],10:[function(t,e,r){var n=t("./common.js"),i={};i.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.fromValues=function(t,e,r,i){var a=new n.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=i,a},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+a*a)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return r*r+n*n+i*i+a*a},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];
return e*e+r*r+n*n+i*i},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=a*o),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},i.lerp=function(t,e,r,n){var i=e[0],a=e[1],o=e[2],u=e[3];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t[3]=u+n*(r[3]-u),t},i.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),i.normalize(t,t),i.scale(t,t,e),t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,t},i.transformQuat=function(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],u=r[1],s=r[2],l=r[3],c=l*n+u*a-s*i,f=l*i+s*n-o*a,h=l*a+o*i-u*n,d=-o*n-u*i-s*a;return t[0]=c*l+d*-o+f*-s-h*-u,t[1]=f*l+d*-u+h*-o-c*-s,t[2]=h*l+d*-s+c*-u-f*-o,t[3]=e[3],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,a,o){var u,s;for(r||(r=4),n||(n=0),s=i?Math.min(i*r+n,e.length):e.length,u=n;s>u;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],a(t,t,o),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}(),i.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exports=i},{"./common.js":2}],11:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(e,r){n(this,t),this._array=e,this.itemSize=r,this.length=e.length/r,this.type=t.ArrayBuffer,this.drawType=t.StaticDraw,this.dataType=t.Float,this.normalized=!1,this._preparedGlContext=null}return i(t,[{key:"bind",value:function(e,r){return this._preparedGlContext!==e&&this._unprepare(this._preparedGlContext),this._glBuffer||this._prepare(e),this.type===t.ArrayBuffer?(e.bindBuffer(e.ARRAY_BUFFER,this._glBuffer),e.vertexAttribPointer(r,this.itemSize,this._toGlParam(e,this.dataType),this.normalized,0,0)):this.type===t.ElementArrayBuffer&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._glBuffer),this}},{key:"remove",value:function(t){return this._unprepare(t),this}},{key:"getArray",value:function(){return this._array}},{key:"getElement",value:function(t){return this._array.subarray(t*this.itemSize,(t+1)*this.itemSize)}},{key:"getTriangle",value:function(t){return t*=3,[this.getElement(t),this.getElement(t+1),this.getElement(t+2)]}},{key:"concat",value:function(t){var e=t.getArray(),r=new this._array.constructor(this._array.length+e.length);return r.set(this._array,0),r.set(e,this._array.length),this._array=r,this.length=r.length/this.itemSize,this}},{key:"subData",value:function(t,e,r){return t.bindBuffer(this._toGlParam(t,this.type),this._glBuffer),t.bufferSubData(this._toGlParam(t,this.type),e*this.itemSize,r),this}},{key:"_prepare",value:function(t){this._glBuffer=t.createBuffer(),t.bindBuffer(this._toGlParam(t,this.type),this._glBuffer),t.bufferData(this._toGlParam(t,this.type),this._array,this._toGlParam(t,this.drawType)),this._preparedGlContext=t}},{key:"_unprepare",value:function(t){t&&(this._glBuffer&&t.deleteBuffer(this._glBuffer),this._glBuffer=null)}},{key:"_toGlParam",value:function(e,r){return r===t.ArrayBuffer?e.ARRAY_BUFFER:r===t.ElementArrayBuffer?e.ELEMENT_ARRAY_BUFFER:r===t.StaticDraw?e.STATIC_DRAW:r===t.DynamicDraw?e.DYNAMIC_DRAW:r===t.Float?e.FLOAT:r===t.UnsignedByte?e.UNSIGNED_BYTE:void 0}}]),t}();a.ArrayBuffer=1,a.ElementArrayBuffer=2,a.StaticDraw=10,a.DynamicDraw=11,a.Float=20,a.UnsignedByte=21,r.default=a,e.exports=r.default},{}],12:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix"),u=t("./Buffer"),s=n(u),l=t("./math/Box"),c=n(l),f=function(){function t(){i(this,t),this.buffers={},this._boundingBox=null}return a(t,[{key:"setBuffer",value:function(t,e){return this.buffers[t]=e,this}},{key:"getBuffer",value:function(t){return this.buffers[t]}},{key:"computeNormals",value:function(){var t=this.buffers.position;if(!t)return this;for(var e=new Float32Array(t.length*t.itemSize),r=o.vec3.create(),n=o.vec3.create(),i=o.vec3.create(),a=0;a<t.length;a+=3){var u=t.getTriangle(a/3);o.vec3.sub(r,u[0],u[1]),o.vec3.sub(n,u[2],u[1]),o.vec3.cross(i,r,n),o.vec3.normalize(i,i),e.set(i,3*a),e.set(i,3*(a+1)),e.set(i,3*(a+2))}return this.setBuffer("normal",new s.default(e,3)),this}},{key:"getBoundingBox",value:function(){return this._boundingBox||this.computeBoundingBox(),this._boundingBox}},{key:"computeBoundingBox",value:function(){var t=this._boundingBox=new c.default,e=this.buffers.position;if(e)for(var r=0;r<e.length;r++)t.expandByPoint(e.getElement(r))}},{key:"concat",value:function(t){for(var e in this.buffers)this.buffers[e].concat(t.buffers[e])}}]),t}();r.default=f,e.exports=r.default},{"./Buffer":11,"./math/Box":40,"gl-matrix":1}],13:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("./Object3D"),l=n(s),c=t("./libConstants"),f=n(c),h=function(t){function e(t,r){i(this,e);var n=a(this,Object.getPrototypeOf(e).call(this));return n.geometry=t,n.material=r,n.type=f.default.MESH,n}return o(e,t),u(e,[{key:"render",value:function(t){var e=t.gl;return this.visible?(this.worldMatrixNeedsUpdate&&this.updateWorldMatrix(),t.object=this,this.material.enable(t),e.drawArrays(e.TRIANGLES,0,this.geometry.getBuffer("position").length),this.material.disable(e),this):this}},{key:"typifyForRender",value:function(t){return this.visible?(this.material.typifyForRender(t,this),this.children.forEach(function(e){return e.typifyForRender(t)}),this):this}}]),e}(l.default);r.default=h,e.exports=r.default},{"./Object3D":15,"./libConstants":30}],14:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("./Object3D"),l=n(s),c=t("./Geometry"),f=n(c),h=t("./Buffer"),d=n(h),p=t("./libConstants"),v=n(p);t("./rendererPlugins/MultiSpritePlugin");var m=function(t){function e(t,r){i(this,e);var n=a(this,Object.getPrototypeOf(e).call(this));return n.material=r,n.type=v.default.MULTI_SPRITE,n._initArrays(t),n._initGeometry(),n}return o(e,t),u(e,[{key:"setOpacity",value:function(t,e){var r=this._data.colorAlpha.array,n=6*t;return r[n]=e,r[n+1]=e,r[n+2]=e,r[n+3]=e,r[n+4]=e,r[n+5]=e,this._data.colorAlpha.dirty=!0,this}},{key:"setPosition",value:function(t,e){var r=this._data.position.array,n=18*t;return r[n]=e[0],r[n+1]=e[1],r[n+3]=e[0],r[n+4]=e[1],r[n+6]=e[0],r[n+7]=e[1],r[n+9]=e[0],r[n+10]=e[1],r[n+12]=e[0],r[n+13]=e[1],r[n+15]=e[0],r[n+16]=e[1],this._data.position.dirty=!0,this}},{key:"setElevation",value:function(t,e){var r=this._data.position.array,n=18*t;return r[n+2]=e,r[n+5]=e,r[n+8]=e,r[n+11]=e,r[n+14]=e,r[n+17]=e,this._data.position.dirty=!0,this}},{key:"setSize",value:function(t,e){var r=this._data.scale.array,n=12*t;return r[n]=e[0],r[n+1]=e[1],r[n+2]=e[0],r[n+3]=e[1],r[n+4]=e[0],r[n+5]=e[1],r[n+6]=e[0],r[n+7]=e[1],r[n+8]=e[0],r[n+9]=e[1],r[n+10]=e[0],r[n+11]=e[1],this._data.scale.dirty=!0,this}},{key:"setOffset",value:function(t,e){var r=this._data.offset.array,n=12*t;return r[n]=e[0],r[n+1]=e[1],r[n+2]=e[0],r[n+3]=e[1],r[n+4]=e[0],r[n+5]=e[1],r[n+6]=e[0],r[n+7]=e[1],r[n+8]=e[0],r[n+9]=e[1],r[n+10]=e[0],r[n+11]=e[1],this._data.offset.dirty=!0,this}},{key:"setUV",value:function(t,e){var r=this._data.texture.array,n=12*t;return r[n]=e[2],r[n+1]=1-e[3],r[n+2]=e[2],r[n+3]=1-e[1],r[n+4]=e[0],r[n+5]=1-e[3],r[n+6]=e[0],r[n+7]=1-e[1],r[n+8]=e[0],r[n+9]=1-e[3],r[n+10]=e[2],r[n+11]=1-e[1],this._data.texture.dirty=!0,this}},{key:"render",value:function(t){var e=t.gl,r=t.shaderProgram,n=this._geometry;r.bind(e,null,{texture:n.getBuffer("texture"),position:n.getBuffer("position"),colorAlpha:n.getBuffer("colorAlpha"),scale:n.getBuffer("scale"),offset:n.getBuffer("offset"),disposition:n.getBuffer("disposition")});for(var i in this._data)this._data[i].dirty&&(this._geometry.getBuffer(i).subData(e,0,this._data[i].array),this._data[i].dirty=!1);return this.material.enable(t),e.drawArrays(e.TRIANGLES,0,this._geometry.getBuffer("disposition").length),this.material.disable(),this}},{key:"typifyForRender",value:function(t){return this.visible&&this.material.getTexture()?(t[v.default.MULTI_SPRITE_RENDERER].addObject(this),this.children.forEach(function(e){return e.typifyForRender(t)}),this):this}},{key:"_initArrays",value:function(t){var e=t.length,r=[.5,-.5,0,.5,.5,0,-.5,-.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0],n=new Float32Array(18*e),i=new Float32Array(12*e),a=new Float32Array(18*e),o=new Float32Array(12*e),u=new Float32Array(12*e),s=new Float32Array(6*e);this._data={disposition:{array:n,dirty:!1},texture:{array:i,dirty:!1},position:{array:a,dirty:!1},scale:{array:o,dirty:!1},offset:{array:u,dirty:!1},colorAlpha:{array:s,dirty:!1}};for(var l=0;e>l;l++){var c=t[l];n.set(r,18*l),this.setUV(l,c.uv||[0,0,1,1]),this.setSize(l,c.size||[0,0]),this.setOffset(l,c.offset||[0,0]),this.setOpacity(l,void 0!==c.opacity?c.opacity:1),this.setPosition(l,c.position),this.setElevation(l,c.elevation||0)}}},{key:"_initGeometry",value:function(){this._geometry=new f.default;var t=new d.default(this._data.texture.array,2);t.drawType=d.default.DynamicDraw;var e=new d.default(this._data.position.array,3);e.drawType=d.default.DynamicDraw;var r=new d.default(this._data.scale.array,2);r.drawType=d.default.DynamicDraw;var n=new d.default(this._data.offset.array,2);n.drawType=d.default.DynamicDraw;var i=new d.default(this._data.colorAlpha.array,1);i.drawType=d.default.DynamicDraw;var a=new d.default(this._data.disposition.array,3);this._geometry.setBuffer("disposition",a).setBuffer("texture",t).setBuffer("position",e).setBuffer("scale",r).setBuffer("offset",n).setBuffer("colorAlpha",i)}}]),e}(l.default);r.default=m,e.exports=r.default},{"./Buffer":11,"./Geometry":12,"./Object3D":15,"./libConstants":30,"./rendererPlugins/MultiSpritePlugin":47}],15:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix"),u=t("./libConstants"),s=n(u);t("./rendererPlugins/CommonPlugin");var l=function(){function t(){i(this,t),this.children=[],this.parent=null,this.visible=!0,this.renderOrder=0,this.scale=o.vec3.fromValues(1,1,1),this.position=o.vec3.create(),this.quaternion=o.quat.create(),this.localMatrix=o.mat4.create(),this.worldMatrix=o.mat4.create(),this.worldMatrixNeedsUpdate=!1,this.type=s.default.OBJECT_3D}return a(t,[{key:"add",value:function(t){return t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),this}},{key:"remove",value:function(t){var e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1)),this}},{key:"render",value:function(t){return this.visible?(this.worldMatrixNeedsUpdate&&this.updateWorldMatrix(),this):this}},{key:"updateLocalMatrix",value:function(){return o.mat4.fromRotationTranslationScale(this.localMatrix,this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0,this}},{key:"updateWorldMatrix",value:function(){return this.parent?o.mat4.mul(this.worldMatrix,this.parent.worldMatrix,this.localMatrix):o.mat4.copy(this.worldMatrix,this.localMatrix),this.children.forEach(function(t){return t.updateWorldMatrix()}),this.worldMatrixNeedsUpdate=!1,this}},{key:"getWorldPosition",value:function(){return o.vec3.fromValues(this.worldMatrix[12],this.worldMatrix[13],this.worldMatrix[14])}},{key:"traverse",value:function(t){return t(this),this.children.forEach(function(e){return e.traverse(t)}),this}},{key:"traverseVisible",value:function(t){return this.visible?(t(this),this.children.forEach(function(e){return e.traverseVisible(t)}),this):this}},{key:"typifyForRender",value:function(t){return this.visible?(t[s.default.COMMON_RENDERER].addObject(this),this.children.forEach(function(e){return e.typifyForRender(t)}),this):this}}]),t}();r.default=l,e.exports=r.default},{"./libConstants":30,"./rendererPlugins/CommonPlugin":46,"gl-matrix":1}],16:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=t("gl-matrix"),s=t("./math/Ray"),l=n(s),c=t("./libConstants"),f=n(c),h=function(){function t(e,r,n,o){a(this,t),this.precision=1e-4,this.ray=new l.default(e,r),this.near=n||0,this.far=o||1/0,this.intersectMethodsByType=i({},f.default.MESH,"intersectMesh")}return o(t,[{key:"setFromCamera",value:function(t,e){if(e.type===f.default.PERSPECTIVE_CAMERA){this.ray.origin=u.vec3.clone(e.position);var r=u.vec3.fromValues(t[0],t[1],.5);r=e.unproject(r),u.vec3.sub(r,r,e.position),u.vec3.normalize(r,r),this.ray.direction=r}else if(e.type===f.default.ORTHOGRAPHIC_CAMERA){var n=u.vec3.fromValues(t[0],t[1],-1);this.ray.origin=e.unproject(n),this.ray.direction=u.vec3.fromValues(0,0,-1);var i=u.mat3.create();u.mat3.fromMat4(i,e.worldMatrix),u.vec3.transformMat3(this.ray.direction,this.ray.direction,i),u.vec3.normalize(this.ray.direction,this.ray.direction)}}},{key:"intersectObject",value:function(t,e,r){r=r||[];var n=this.intersectMethodsByType[t.type];return n&&this[n]?this[n](t,e,r):e&&this.intersectObjects(t.children,e,r),r.sort(this._descSort),r}},{key:"intersectObjects",value:function(t,e,r){var n=this;return r=r||[],t.forEach(function(t){return n.intersectObject(t,e,r)}),r}},{key:"intersectMesh",value:function(t,e,r){r=r||[];var n=u.mat4.create();u.mat4.invert(n,t.worldMatrix);var i=this.ray.clone();i.applyMatrix4(n);var a=t.geometry.getBoundingBox();if(!i.intersectBox(a))return t;for(var o=t.geometry.buffers.position,s=0;s<o.length;s+=3){var l=o.getTriangle(s/3),c=i.intersectTriangle(l,!1);if(c){u.vec3.transformMat4(c,c,t.worldMatrix);var f=u.vec3.dist(this.ray.origin,c);f<this.precision||f<this.near||f>this.far||r.push({distance:f,point:c,object:t})}}return e&&this.intersectObjects(t.children,e,r),r}},{key:"_descSort",value:function(t,e){return t.distance-e.distance}}]),t}();r.default=h,e.exports=r.default},{"./libConstants":30,"./math/Ray":45,"gl-matrix":1}],17:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("./Texture"),u=n(o),s=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,t),this._size=e.size}return a(t,[{key:"bind",value:function(t){return this._sizeChanged&&(this._unprepare(t),this._sizeChanged=!1),this._frameBuffer||this._prepare(t),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),this}},{key:"unbind",value:function(t){return t.bindFramebuffer(t.FRAMEBUFFER,null),this}},{key:"remove",value:function(t){return this._unprepare(t),this}},{key:"setSize",value:function(t){return this._size=t,this._sizeChanged=!0,this}},{key:"_prepare",value:function(t){this._texture=new u.default,this._texture.generateMipmaps=!1,this._texture.size=this._size,this._texture._prepare(t),this._frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),this._renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this._renderBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this._size[0],this._size[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._texture._texture,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this._renderBuffer),this._checkComplete(t),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)}},{key:"_unprepare",value:function(t){this._frameBuffer&&(this._texture.remove(t),t.deleteFramebuffer(this._frameBuffer),t.deleteRenderbuffer(this._renderBuffer),this._frameBuffer=null)}},{key:"_checkComplete",value:function(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);e!==t.FRAMEBUFFER_COMPLETE&&(e===t.FRAMEBUFFER_UNSUPPORTED?console.log("Framebuffer is unsupported"):e===t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT?console.log("Framebuffer incomplete attachment"):e===t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS?console.log("Framebuffer incomplete dimensions"):e===t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT?console.log("Framebuffer incomplete missing attachment"):console.log("Unexpected framebuffer status: "+e))}}]),t}();r.default=s,e.exports=r.default},{"./Texture":25}],18:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(e){var r=this;if(n(this,t),e=e||{},e.canvas){this._canvasElement="string"==typeof e.canvas?document.getElementById(e.canvas):e.canvas;var i={antialias:void 0!==e.antialias?e.antialias:!0};this._gl=this._canvasElement.getContext("webgl",i)||this._canvasElement.getContext("experimental-webgl",i)}else this._gl=e.gl;this._pixelRatio=e.pixelRatio||1,this.autoClear=void 0!==e.autoClear?e.autoClear:!0,this.clearColor=e.clearColor||[1,1,1,1],this.sortObjects=!0,this._plugins=[],this._pluginsByType={},t.plugins.forEach(function(t){var e=new t.Plugin(r);r._plugins.push(e),r._pluginsByType[e.type]=e})}return i(t,[{key:"setPixelRatio",value:function(t){return this._pixelRatio=t,this}},{key:"getPixelRatio",value:function(){return this._pixelRatio}},{key:"setSize",value:function(t,e){return this._size=[t*this._pixelRatio,e*this._pixelRatio],this._canvasElement&&(this._canvasElement.width=this._size[0],this._canvasElement.height=this._size[1],this._canvasElement.style.width=t+"px",this._canvasElement.style.height=e+"px"),this.setViewport(),this}},{key:"setViewport",value:function(t,e){return void 0!==t&&void 0!==e?this._gl.viewport(0,0,t,e):this._gl.viewport(0,0,this._size[0],this._size[1]),this}},{key:"getSize",value:function(){return this._size}},{key:"setRenderTarget",value:function(t){return this._renderTarget=t,this}},{key:"readPixels",value:function(t,e,r,n,i){var a=this._gl;return this._renderTarget?(this._renderTarget.bind(a),a.readPixels(t,e,r,n,a.RGBA,a.UNSIGNED_BYTE,i),this._renderTarget.unbind(a)):a.readPixels(t,e,r,n,a.RGBA,a.UNSIGNED_BYTE,i),this}},{key:"clear",value:function(){var t=this._gl;return t.clearColor.apply(t,this.clearColor),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this}},{key:"render",value:function(t,e){var r=this._gl;t.typifyForRender(this._pluginsByType),this._renderTarget&&this._renderTarget.bind(r),r.clearDepth(1),r.clearStencil(0),this.autoClear&&this.clear(),e.updateLocalMatrix(),e.updateWorldMatrix();var n={renderer:this,scene:t,camera:e,gl:r};return this._plugins.forEach(function(t){t.render(n)}),this._renderTarget&&this._renderTarget.unbind(r),this}}],[{key:"addPlugin",value:function(e,r){t.plugins.push({Plugin:r,order:e}),t.plugins.sort(function(t,e){return e.order<t.order})}},{key:"removePlugin",value:function(e){t.plugins.some(function(r,n){return r.Plugin===e?(t.plugins.splice(n,1),!0):void 0})}}]),t}();a.plugins=[],r.default=a,e.exports=r.default},{}],19:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(){n(this,t),this._objects=[]}return i(t,[{key:"render",value:function(){this._objects=[]}},{key:"addObject",value:function(t){return this._objects.push(t),this}}]),t}();r.default=a,e.exports=r.default},{}],20:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("./Object3D"),l=n(s),c=function(t){function e(){i(this,e);var t=a(this,Object.getPrototypeOf(e).call(this));return t._lights=[],t}return o(e,t),u(e,[{key:"addLight",value:function(t){return this._lights.push(t),this}},{key:"getLights",value:function(){return this._lights}}]),e}(l.default);r.default=c,e.exports=r.default},{"./Object3D":15}],21:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(e){n(this,t),this.name=e.name,this.index=e.index,this.location=-1}return i(t,[{key:"setLocation",value:function(t,e){return this.location=t.getAttribLocation(e,this.name),this}},{key:"enable",value:function(t){return this.index!==!0&&t.enableVertexAttribArray(this.location),this}},{key:"bind",value:function(t,e){return e.bind(t,this.location),this}},{key:"disable",value:function(t){return this.index!==!0&&t.disableVertexAttribArray(this.location),this}}]),t}();e.exports=a},{}],22:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("./ShaderAttribute"),u=n(o),s=t("./ShaderUniform"),l=n(s),c=function(){function t(e){var r=this;i(this,t),e=e||{},this._vertexShaderCode=e.vertex||"",this._fragmentShaderCode=e.fragment||"",this._uniforms={},e.uniforms=e.uniforms||[],e.uniforms.forEach(function(t){r._uniforms[t.name]=new l.default(t)}),this._attributes={},e.attributes=e.attributes||[],e.attributes.forEach(function(t){r._attributes[t.name]=new u.default(t)}),this._definitions=e.definitions||[],this._status=t.NOT_READY}return a(t,[{key:"enable",value:function(e){if(this._status===t.NOT_READY&&this._prepare(e),this._status!==t.READY)return this;e.useProgram(this._webglProgram);for(var r in this._attributes)this._attributes[r].enable(e);return this}},{key:"bind",value:function(t,e,r){if(e)for(var n in e)this._uniforms[n].bind(t,e[n]);if(r)for(var i in r)this._attributes[i].bind(t,r[i]);return this}},{key:"disable",value:function(t){for(var e in this._attributes)this._attributes[e].disable(t);return this}},{key:"_prepare",value:function(t){this._prepareShaders(t),this._prepareAttributes(t),this._prepareUniforms(t)}},{key:"_prepareShaders",value:function(e){var r=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(r,this._addDefinitions(this._fragmentShaderCode)),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))return console.log(e.getShaderInfoLog(r)),void(this._status=t.FAILED);var n=e.createShader(e.VERTEX_SHADER);return e.shaderSource(n,this._addDefinitions(this._vertexShaderCode)),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?(this._webglProgram=e.createProgram(),e.attachShader(this._webglProgram,n),e.attachShader(this._webglProgram,r),e.linkProgram(this._webglProgram),e.getProgramParameter(this._webglProgram,e.LINK_STATUS)?(this._status=t.READY,this._fragmentShaderCode=null,void(this._vertexShaderCode=null)):(console.log("Could not initialize shaders"),void(this._status=t.FAILED))):(console.log(e.getShaderInfoLog(n)),void(this._status=t.FAILED))}},{key:"_addDefinitions",value:function(t){return this._definitions.map(function(t){return void 0!==t.value?"#define "+t.type+" "+t.value:"#define "+t.type}).join("\n")+"\n"+t}},{key:"_prepareAttributes",value:function(t){for(var e in this._attributes)this._attributes[e].setLocation(t,this._webglProgram)}},{key:"_prepareUniforms",value:function(t){for(var e in this._uniforms)this._uniforms[e].setLocation(t,this._webglProgram)}}]),t}();c.NOT_READY=1,c.READY=2,c.FAILED=3,e.exports=c},{"./ShaderAttribute":21,"./ShaderUniform":23}],23:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(e){n(this,t),this.name=e.name,this.type=e.type,this.location=-1}return i(t,[{key:"setLocation",value:function(t,e){return this.location=t.getUniformLocation(e,this.name),this}},{key:"bind",value:function(t,e){var r=this.type;return"mat2"===r?t.uniformMatrix2fv(this.location,!1,e):"mat3"===r?t.uniformMatrix3fv(this.location,!1,e):"mat4"===r?t.uniformMatrix4fv(this.location,!1,e):"2f"===r?t.uniform2f(this.location,e[0],e[1]):"3f"===r?t.uniform3f(this.location,e[0],e[1],e[2]):"4f"===r?t.uniform4f(this.location,e[0],e[1],e[2],e[3]):"2i"===r?t.uniform2i(this.location,e[0],e[1]):"3i"===r?t.uniform3i(this.location,e[0],e[1],e[2]):"4i"===r?t.uniform4i(this.location,e[0],e[1],e[2],e[3]):t["uniform"+r](this.location,e),this}}]),t}();e.exports=a},{}],24:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("./Object3D"),l=n(s),c=t("gl-matrix"),f=t("./libConstants"),h=n(f);t("./rendererPlugins/SpritePlugin");var d=function(t){function e(t){i(this,e);var r=a(this,Object.getPrototypeOf(e).call(this));return r.material=t,r.offset=c.vec2.create(),r.type=h.default.SPRITE,r}return o(e,t),u(e,[{key:"render",value:function(t){if(!this.visible||!this.material.getTexture())return this;this.worldMatrixNeedsUpdate&&this.updateWorldMatrix();var e=t.gl;return t.object=this,this.material.enable(t),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),this.material.disable(t.gl),this}},{key:"typifyForRender",value:function(t){return this.visible?(t[h.default.SPRITE_RENDERER].addObject(this),this.children.forEach(function(e){return e.typifyForRender(t)}),this):this}}]),e}(l.default);r.default=d,e.exports=r.default},{"./Object3D":15,"./libConstants":30,"./rendererPlugins/SpritePlugin":48,"gl-matrix":1}],25:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(e){n(this,t),this._src=e||null,this.magFilter=t.LinearFilter,
this.minFilter=t.LinearMipMapLinearFilter,this.wrapS=t.ClampToEdgeWrapping,this.wrapT=t.ClampToEdgeWrapping,this.generateMipmaps=!0}return i(t,[{key:"enable",value:function(t,e){return this._texture||this._prepare(t),t.bindTexture(t.TEXTURE_2D,this._texture),e&&t.activeTexture(t.TEXTURE0),this}},{key:"remove",value:function(t){return this._texture&&t.deleteTexture(this._texture),this}},{key:"_prepare",value:function(e){this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.size?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.size[0],this.size[1],0,e.RGBA,e.UNSIGNED_BYTE,this._src):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._src),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this._toGlParam(e,this.wrapS)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this._toGlParam(e,this.wrapT)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this._toGlParam(e,this.magFilter)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this._toGlParam(e,this.minFilter)),this.generateMipmaps&&this.minFilter!==t.NearestFilter&&this.minFilter!==t.LinearFilter&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null)}},{key:"_toGlParam",value:function(e,r){return r===t.ClampToEdgeWrapping?e.CLAMP_TO_EDGE:r===t.NearestFilter?e.NEAREST:r===t.NearestMipMapNearestFilter?e.NEAREST_MIPMAP_NEAREST:r===t.NearestMipMapLinearFilter?e.NEAREST_MIPMAP_LINEAR:r===t.LinearFilter?e.LINEAR:r===t.LinearMipMapNearestFilter?e.LINEAR_MIPMAP_NEAREST:r===t.LinearMipMapLinearFilter?e.LINEAR_MIPMAP_LINEAR:void 0}}]),t}();a.ClampToEdgeWrapping=8,a.NearestFilter=1,a.NearestMipMapNearestFilter=2,a.NearestMipMapLinearFilter=3,a.LinearFilter=4,a.LinearMipMapNearestFilter=5,a.LinearMipMapLinearFilter=6,r.default=a,e.exports=r.default},{}],26:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,r,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},l=t("../Object3D"),c=n(l),f=t("gl-matrix"),h=function(t){function e(){i(this,e);var t=a(this,Object.getPrototypeOf(e).call(this));return t.up=f.vec3.fromValues(0,1,0),t.projectionMatrix=f.mat4.create(),t.modelViewMatrix=f.mat4.create(),t.worldInverseMatrix=f.mat4.create(),t}return o(e,t),u(e,[{key:"updateProjectionMatrix",value:function(){}},{key:"updateWorldMatrix",value:function(){s(Object.getPrototypeOf(e.prototype),"updateWorldMatrix",this).call(this),f.mat4.invert(this.worldInverseMatrix,this.worldMatrix),f.mat4.multiply(this.modelViewMatrix,this.projectionMatrix,this.worldInverseMatrix)}},{key:"project",value:function(t){var e=f.vec3.create();return f.vec3.transformMat4(e,t,this.modelViewMatrix),e}},{key:"unproject",value:function(t){var e=f.mat4.create(),r=f.mat4.create(),n=f.vec3.create();return f.mat4.invert(r,this.projectionMatrix),f.mat4.mul(e,this.worldMatrix,r),f.vec3.transformMat4(n,t,e),n}},{key:"lookAt",value:function(t){var e=f.mat4.create(),r=f.mat3.create();return f.mat4.lookAt(e,this.position,t,this.up),f.mat4.transpose(e,e),f.mat3.fromMat4(r,e),f.quat.fromMat3(this.quaternion,r),this}}]),e}(c.default);r.default=h,e.exports=r.default},{"../Object3D":15,"gl-matrix":1}],27:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("gl-matrix"),l=t("./Camera"),c=n(l),f=t("../libConstants"),h=n(f),d=function(t){function e(t,r,n,o,u,s){i(this,e);var l=a(this,Object.getPrototypeOf(e).call(this));return l.left=t,l.right=r,l.top=n,l.bottom=o,l.near=u,l.far=s,l.type=h.default.ORTHOGRAPHIC_CAMERA,l}return o(e,t),u(e,[{key:"updateProjectionMatrix",value:function(){s.mat4.ortho(this.projectionMatrix,this.left,this.right,this.bottom,this.top,this.near,this.far)}}]),e}(c.default);r.default=d,e.exports=r.default},{"../libConstants":30,"./Camera":26,"gl-matrix":1}],28:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("gl-matrix"),l=t("./Camera"),c=n(l),f=t("../math/Math"),h=t("../libConstants"),d=n(h),p=function(t){function e(t,r,n,o){i(this,e);var u=a(this,Object.getPrototypeOf(e).call(this));return u.fov=t,u.aspect=r,u.near=n,u.far=o,u.type=d.default.PERSPECTIVE_CAMERA,u}return o(e,t),u(e,[{key:"updateProjectionMatrix",value:function(){s.mat4.perspective(this.projectionMatrix,(0,f.degToRad)(this.fov),this.aspect,this.near,this.far)}}]),e}(c.default);r.default=p,e.exports=r.default},{"../libConstants":30,"../math/Math":43,"./Camera":26,"gl-matrix":1}],29:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}var a=t("./Renderer"),o=i(a),u=t("./RendererPlugin"),s=i(u),l=t("./Object3D"),c=i(l),f=t("./cameras/PerspectiveCamera"),h=i(f),d=t("./cameras/OrthographicCamera"),p=i(d),v=t("./Buffer"),m=i(v),y=t("./Geometry"),b=i(y),_=t("./ShaderProgram"),g=i(_),M=t("./materials/BasicMeshMaterial"),E=i(M),x=t("./materials/ComplexMeshMaterial"),P=i(x),w=t("./materials/SpriteMaterial"),T=i(w),R=t("./materials/MultiSpriteMaterial"),O=i(R),A=t("./Mesh"),j=i(A),C=t("./Sprite"),S=i(C),k=t("./MultiSprite"),D=i(k),L=t("./Scene"),F=i(L),B=t("./Texture"),N=i(B),I=t("./lights/AmbientLight"),U=i(I),z=t("./lights/DirectionalLight"),q=i(z),Y=t("./Raycaster"),G=i(Y),H=t("./RenderTarget"),V=i(H),X=t("./math/Ray"),W=i(X),K=t("./math/Plane"),Q=i(K),Z=t("./math/Box"),J=i(Z),$=t("./math/Frustum"),tt=i($),et=t("./math/Math"),rt=n(et),nt=t("./math/Line3"),it=i(nt),at=t("gl-matrix");at.glMatrix.ARRAY_TYPE="undefined"!=typeof Float64Array?Float64Array:Array;var ot={Renderer:o.default,RendererPlugin:s.default,Object3D:c.default,PerspectiveCamera:h.default,OrthographicCamera:p.default,Buffer:m.default,Geometry:b.default,Mesh:j.default,Sprite:S.default,MultiSprite:D.default,ShaderProgram:g.default,BasicMeshMaterial:E.default,ComplexMeshMaterial:P.default,SpriteMaterial:T.default,MultiSpriteMaterial:O.default,Scene:F.default,Texture:N.default,AmbientLight:U.default,DirectionalLight:q.default,Raycaster:G.default,RenderTarget:V.default,Ray:W.default,Plane:Q.default,Frustum:tt.default,Box:J.default,Line3:it.default,Math:rt,vec3:at.vec3,mat3:at.mat3,vec2:at.vec2,mat4:at.mat4,quat:at.quat};e.exports=ot},{"./Buffer":11,"./Geometry":12,"./Mesh":13,"./MultiSprite":14,"./Object3D":15,"./Raycaster":16,"./RenderTarget":17,"./Renderer":18,"./RendererPlugin":19,"./Scene":20,"./ShaderProgram":22,"./Sprite":24,"./Texture":25,"./cameras/OrthographicCamera":27,"./cameras/PerspectiveCamera":28,"./lights/AmbientLight":31,"./lights/DirectionalLight":32,"./materials/BasicMeshMaterial":34,"./materials/ComplexMeshMaterial":35,"./materials/MultiSpriteMaterial":37,"./materials/SpriteMaterial":38,"./math/Box":40,"./math/Frustum":41,"./math/Line3":42,"./math/Math":43,"./math/Plane":44,"./math/Ray":45,"gl-matrix":1}],30:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={ORTHOGRAPHIC_CAMERA:1,PERSPECTIVE_CAMERA:2,AMBIENT_LIGHT:3,DIRECTIONAL_LIGHT:4,BASIC_MESH_MATERIAL:5,COMPLEX_MESH_MATERIAL:6,SPRITE_MATERIAL:7,MULTI_SPRITE_MATERIAL:8,MESH:9,SPRITE:10,MULTI_SPRITE:11,OBJECT_3D:12,COMMON_RENDERER:13,TRANSPARENT_RENDERER:14,SPRITE_RENDERER:15,MULTI_SPRITE_RENDERER:16},e.exports=r.default},{}],31:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=t("../libConstants"),s=n(u),l=t("./Light"),c=n(l),f=function(t){function e(t){i(this,e);var r=a(this,Object.getPrototypeOf(e).call(this,t));return r.type=s.default.AMBIENT_LIGHT,r}return o(e,t),e}(c.default);r.default=f,e.exports=r.default},{"../libConstants":30,"./Light":33}],32:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=t("../libConstants"),s=n(u),l=t("./Light"),c=n(l),f=function(t){function e(t){i(this,e);var r=a(this,Object.getPrototypeOf(e).call(this,t));return r.type=s.default.DIRECTIONAL_LIGHT,r}return o(e,t),e}(c.default);r.default=f,e.exports=r.default},{"../libConstants":30,"./Light":33}],33:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=t("../Object3D"),s=n(u),l=function(t){function e(t){i(this,e);var r=a(this,Object.getPrototypeOf(e).call(this));return r.color=t,r}return o(e,t),e}(s.default);r.default=l,e.exports=r.default},{"../Object3D":15}],34:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("../shaders/basic.frag.js"),l=n(s),c=t("../shaders/basic.vert.js"),f=n(c),h=t("./Material"),d=n(h),p=t("../libConstants"),v=n(p),m={fragment:l.default,vertex:f.default},y=function(t){function e(){i(this,e);var t=a(this,Object.getPrototypeOf(e).call(this));return t._attributes=[{name:"position"}],t._uniforms=[{name:"uColorAlpha",type:"1f"},{name:"uCamera",type:"mat4"},{name:"uPosition",type:"mat4"},{name:"uColor",type:"3fv"}],t._shader=m,t.color=[0,0,0],t.type=v.default.BASIC_MESH_MATERIAL,t}return o(e,t),u(e,[{key:"_shaderProgramBind",value:function(t){var e=t.gl,r=t.object,n=t.camera,i={};this._attributes.forEach(function(t){i[t.name]=r.geometry.getBuffer(t.name)});var a={uColorAlpha:this.opacity,uPosition:new Float32Array(r.worldMatrix),uCamera:new Float32Array(n.modelViewMatrix),uColor:this.color};this._shaderProgram.bind(e,a,i)}}]),e}(d.default);r.default=y,e.exports=r.default},{"../libConstants":30,"../shaders/basic.frag.js":50,"../shaders/basic.vert.js":51,"./Material":36}],35:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,r,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},l=t("../shaders/complex.frag.js"),c=n(l),f=t("../shaders/complex.vert.js"),h=n(f),d=t("gl-matrix"),p=t("./Material"),v=n(p),m=t("../libConstants"),y=n(m),b={fragment:c.default,vertex:h.default},_=function(t){function e(){i(this,e);var t=a(this,Object.getPrototypeOf(e).call(this));return t._attributes=[{name:"position"},{name:"color"},{name:"emissive"}],t._uniforms=[{name:"uColorAlpha",type:"1f"},{name:"uCamera",type:"mat4"},{name:"uPosition",type:"mat4"},{name:"uAmbientLightColor",type:"3fv"}],t._shader=b,t._texture=null,t.type=y.default.COMPLEX_MESH_MATERIAL,t}return o(e,t),u(e,[{key:"setTexture",value:function(t){return this._texture=t,this}},{key:"getTexture",value:function(){return this._texture}},{key:"_prepare",value:function(t){this._enableLight(t),this._texture&&this._enableTexture(),s(Object.getPrototypeOf(e.prototype),"_prepare",this).call(this,t)}},{key:"_enableLight",value:function(t){var e=t.scene,r=0;e.getLights().forEach(function(t){t.type===y.default.DIRECTIONAL_LIGHT&&r++}),this.define("directionLights",r),r>0&&(this._attributes.push({name:"normal"}),this._uniforms.push({name:"uDirectionLightColors",type:"3fv"},{name:"uDirectionLightPositions",type:"3fv"},{name:"uNormalMatrix",type:"mat3"}))}},{key:"_enableTexture",value:function(){this.define("texture"),this._attributes.push({name:"texture"},{name:"textureEnable"}),this._uniforms.push({name:"uTexture",type:"1i"})}},{key:"_shaderProgramBind",value:function(t){var e=t.gl,r=t.scene,n=t.camera,i=t.object,a={},o={};this._texture&&(this._texture.enable(e,!0),a.uTexture=0);var u=r.getLights();u.length&&!function(){var t=[],e=[];if(u.forEach(function(r){if(r.type===y.default.AMBIENT_LIGHT)a.uAmbientLightColor=r.color;else if(r.type===y.default.DIRECTIONAL_LIGHT){t=t.concat(r.color);var n=d.vec3.create();d.vec3.scale(n,r.position,-1),e=e.concat(Array.prototype.slice.call(n))}}),t.length&&e.length){var r=d.mat3.create();d.mat3.fromMat4(r,i.worldMatrix),d.mat3.invert(r,r),d.mat3.transpose(r,r),a.uNormalMatrix=new Float32Array(r),o.normal=i.geometry.getBuffer("normal")}a.uDirectionLightColors=new Float32Array(t),a.uDirectionLightPositions=new Float32Array(e)}(),this._attributes.forEach(function(t){"normal"!==t.name&&(o[t.name]=i.geometry.getBuffer(t.name))}),a.uPosition=new Float32Array(i.worldMatrix),a.uCamera=new Float32Array(n.modelViewMatrix),a.uColorAlpha=this.opacity,this._shaderProgram.bind(e,a,o)}}]),e}(v.default);r.default=_,e.exports=r.default},{"../libConstants":30,"../shaders/complex.frag.js":52,"../shaders/complex.vert.js":53,"./Material":36,"gl-matrix":1}],36:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("./definitions"),u=n(o),s=t("../ShaderProgram"),l=n(s),c=t("../libConstants"),f=n(c);t("../rendererPlugins/CommonPlugin"),t("../rendererPlugins/TransparentPlugin");var h={},d=function(){function t(){i(this,t),this._attributes=[],this._uniforms=[{name:"uColorAlpha",type:"1f"}],this._definitions=[],this._shader=null,this.opacity=1}return a(t,[{key:"enable",value:function(t){return this._shaderProgram||this._prepare(t),this._shaderProgram.enable(t.gl),this._shaderProgramBind(t),this}},{key:"disable",value:function(t){return this._shaderProgram&&this._shaderProgram.disable(t),this}},{key:"define",value:function(t,e){return u.default[t]&&this._definitions.push({type:u.default[t],value:e}),this}},{key:"typifyForRender",value:function(t,e){1===this.opacity?t[f.default.COMMON_RENDERER].addObject(e):t[f.default.TRANSPARENT_RENDERER].addObject(e)}},{key:"_getCachedProgramKey",value:function(){var t=this.constructor.name;return this._definitions.forEach(function(e){t+=":"+e.type+":"+(e.value||"")}),t}},{key:"_getCachedProgram",value:function(){return h[this._getCachedProgramKey()]}},{key:"_prepare",value:function(t){var e=this._getCachedProgram();return e&&t===e.glContext?void(this._shaderProgram=e.program):(this._shaderProgram=new l.default({vertex:this._shader.vertex,fragment:this._shader.fragment,uniforms:this._uniforms,attributes:this._attributes,definitions:this._definitions}),void(h[this._getCachedProgramKey()]={glContext:t,program:this._shaderProgram}))}},{key:"_shaderProgramBind",value:function(t){var e=t.gl,r=t.object,n={};this._attributes.forEach(function(t){n[t.name]=r.geometry.getBuffer(t.name)});var i={uColorAlpha:this.opacity};this._shaderProgram.bind(e,i,n)}}]),t}();r.default=d,e.exports=r.default},{"../ShaderProgram":22,"../libConstants":30,"../rendererPlugins/CommonPlugin":46,"../rendererPlugins/TransparentPlugin":49,"./definitions":39}],37:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("../libConstants"),u=n(o),s=function(){function t(){i(this,t),this.smoothing=1,this._texture=null,this.type=u.default.MULTI_SPRITE_MATERIAL}return a(t,[{key:"setTexture",value:function(t){return this._texture=t,this}},{key:"getTexture",value:function(){return this._texture}},{key:"enable",value:function(t){var e=t.gl,r=t.shaderProgram;r.bind(e,{uSmoothing:this.smoothing}),this._texture&&this._texture.enable(e)}},{key:"disable",value:function(){}}]),t}();r.default=s,e.exports=r.default},{"../libConstants":30}],38:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("../libConstants"),u=n(o),s=function(){function t(){i(this,t),this.opacity=1,this.smoothing=0,this._texture=null,this.type=u.default.SPRITE_MATERIAL}return a(t,[{key:"setTexture",value:function(t){return this._texture=t,this}},{key:"getTexture",value:function(){return this._texture}},{key:"enable",value:function(t){var e=t.gl,r=t.object,n=t.shaderProgram,i=t.renderer,a=i.getSize();n.bind(e,{uColorAlpha:this.opacity,uSmoothing:this.smoothing,uHalfSize:[a[0]/2,a[1]/2],uOffset:r.offset,uScale:r.scale,uPosition:[r.worldMatrix[12],r.worldMatrix[13],r.worldMatrix[14]]}),this._texture&&this._texture.enable(e)}},{key:"disable",value:function(){}}]),t}();r.default=s,e.exports=r.default},{"../libConstants":30}],39:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={texture:"USE_TEXTURE",directionLights:"DIR_LIGHT_NUM"},e.exports=r.default},{}],40:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("gl-matrix"),o=function(){function t(e,r){n(this,t),this.min=e||a.vec3.create(),this.max=r||a.vec3.create()}return i(t,[{key:"containsPoint",value:function(t){return t[0]>this.min[0]&&t[0]<this.max[0]&&t[1]>this.min[1]&&t[1]<this.max[1]&&t[2]>this.min[2]&&t[2]<this.max[2]}},{key:"expandByPoint",value:function(t){return a.vec3.min(this.min,this.min,t),a.vec3.max(this.max,this.max,t),this}}]),t}();r.default=o,e.exports=r.default},{"gl-matrix":1}],41:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix"),u=t("./Plane"),s=n(u),l=function(){function t(e){i(this,t),this.planes=e,this.planes&&6===this.planes.length||(this.planes=[new s.default,new s.default,new s.default,new s.default,new s.default,new s.default])}return a(t,[{key:"setFromMatrix",value:function(t){return this.planes[0].setComponents(t[12]+t[0],t[13]+t[1],t[14]+t[2],t[15]+t[3]),this.planes[1].setComponents(t[12]-t[0],t[13]-t[1],t[14]-t[2],t[15]-t[3]),this.planes[2].setComponents(t[12]+t[4],t[13]+t[5],t[14]+t[6],t[15]+t[7]),this.planes[3].setComponents(t[12]-t[4],t[13]-t[5],t[14]-t[6],t[15]-t[7]),this.planes[4].setComponents(t[12]+t[8],t[13]+t[9],t[14]+t[10],t[15]+t[11]),this.planes[5].setComponents(t[12]-t[8],t[13]-t[9],t[14]-t[10],t[15]-t[11]),this}},{key:"intersectsBox",value:function(t){for(var e=o.vec3.create(),r=o.vec3.create(),n=this.planes,i=0;6>i;i++){var a=n[i];e[0]=a.normal[0]>0?t.min[0]:t.max[0],r[0]=a.normal[0]>0?t.max[0]:t.min[0],e[1]=a.normal[1]>0?t.min[1]:t.max[1],r[1]=a.normal[1]>0?t.max[1]:t.min[1],e[2]=a.normal[2]>0?t.min[2]:t.max[2],r[2]=a.normal[2]>0?t.max[2]:t.min[2];var u=a.distanceToPoint(e),s=a.distanceToPoint(r);if(0>u&&0>s)return!1}return!0}}]),t}();r.default=l,e.exports=r.default},{"./Plane":44,"gl-matrix":1}],42:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("gl-matrix"),o=t("./Math.js"),u=function(){function t(e,r){n(this,t),this.start=e||a.vec3.create(),this.end=r||a.vec3.create()}return i(t,[{key:"closestPointToPointParameter",value:function(t,e){var r=a.vec3.create(),n=a.vec3.create();a.vec3.sub(r,t,this.start),a.vec3.sub(n,this.end,this.start);var i=a.vec3.dot(n,n),u=a.vec3.dot(n,r),s=u/i;return e&&(s=(0,o.clamp)(s,0,1)),s}},{key:"closestPointToPoint",value:function(t,e,r){var n=this.closestPointToPointParameter(t,e),i=r||a.vec3.create();return i=this.delta(i),a.vec3.scale(i,i,n),a.vec3.add(i,i,this.start),i}},{key:"delta",value:function(t){var e=t||a.vec3.create();return a.vec3.sub(e,this.end,this.start),e}}]),t}();r.default=u,e.exports=r.default},{"./Math.js":43,"gl-matrix":1}],43:[function(t,e,r){"use strict";function n(t,e,r){return e>t?e:t>r?r:t}function i(t){return t*Math.PI/180}Object.defineProperty(r,"__esModule",{value:!0}),r.clamp=n,r.degToRad=i},{}],44:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("gl-matrix"),o=function(){function t(e,r){n(this,t),this.normal=e||a.vec3.create(),this.constant=r||0}return i(t,[{key:"distanceToPoint",value:function(t){return a.vec3.dot(this.normal,t)+this.constant}},{key:"setComponents",value:function(t,e,r,n){return a.vec3.set(this.normal,t,e,r),this.constant=n,this}}]),t}();r.default=o,e.exports=r.default},{"gl-matrix":1}],45:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("gl-matrix"),o=function(){function t(e,r){n(this,t),this.origin=e||a.vec3.create(),this.direction=r||a.vec3.create()}return i(t,[{key:"clone",value:function(){return new t(a.vec3.clone(this.origin),a.vec3.clone(this.direction))}},{key:"at",value:function(t){var e=a.vec3.create();return a.vec3.scaleAndAdd(e,this.origin,this.direction,t),e}},{key:"intersectBox",value:function(t){var e=void 0,r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,u=1/this.direction[0],s=1/this.direction[1],l=1/this.direction[2],c=this.origin;return u>=0?(e=(t.min[0]-c[0])*u,r=(t.max[0]-c[0])*u):(e=(t.max[0]-c[0])*u,r=(t.min[0]-c[0])*u),s>=0?(n=(t.min[1]-c[1])*s,i=(t.max[1]-c[1])*s):(n=(t.max[1]-c[1])*s,i=(t.min[1]-c[1])*s),e>i||n>r?null:((n>e||e!==e)&&(e=n),(r>i||r!==r)&&(r=i),l>=0?(a=(t.min[2]-c[2])*l,o=(t.max[2]-c[2])*l):(a=(t.max[2]-c[2])*l,o=(t.min[2]-c[2])*l),e>o||a>r?null:((a>e||e!==e)&&(e=a),(r>o||r!==r)&&(r=o),0>r?null:this.at(e>=0?e:r)))}},{key:"applyMatrix4",value:function(t){return a.vec3.add(this.direction,this.direction,this.origin),a.vec3.transformMat4(this.direction,this.direction,t),a.vec3.transformMat4(this.origin,this.origin,t),a.vec3.sub(this.direction,this.direction,this.origin),a.vec3.normalize(this.direction,this.direction),this}},{key:"intersectTriangle",value:function(t,e){var r=a.vec3.create(),n=a.vec3.create(),i=a.vec3.create();a.vec3.sub(r,t[1],t[0]),a.vec3.sub(n,t[2],t[0]),a.vec3.cross(i,r,n);var o=a.vec3.dot(this.direction,i),u=void 0;if(o>0){if(e)return null;u=1}else{if(!(0>o))return null;u=-1,o=-o}var s=a.vec3.create();a.vec3.sub(s,this.origin,t[0]);var l=a.vec3.create();a.vec3.cross(l,s,n);var c=u*a.vec3.dot(this.direction,l);if(0>c)return null;var f=a.vec3.create();a.vec3.cross(f,r,s);var h=u*a.vec3.dot(this.direction,f);if(0>h)return null;if(c+h>o)return null;var d=-u*a.vec3.dot(s,i);return 0>d?null:this.at(d/o)}},{key:"distanceToPlane",value:function(t){var e=a.vec3.dot(t.normal,this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var r=-(a.vec3.dot(this.origin,t.normal)+t.constant)/e;return r>=0?r:null}},{key:"intersectPlane",value:function(t){var e=this.distanceToPlane(t);return null===e?null:this.at(e)}}]),t}();r.default=o,e.exports=r.default},{"gl-matrix":1}],46:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("../RendererPlugin"),l=n(s),c=t("../Renderer"),f=n(c),h=t("../libConstants"),d=n(h),p=function(t){function e(){i(this,e);var t=a(this,Object.getPrototypeOf(e).call(this));return t.type=d.default.COMMON_RENDERER,t}
return o(e,t),u(e,[{key:"render",value:function(t){var e=t.gl;return e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.cullFace(e.BACK),e.enable(e.CULL_FACE),e.disable(e.BLEND),t.renderer.sortObjects&&this._objects.sort(this._renderOrderSort),this._objects.forEach(function(e){return e.render(t)}),this._objects=[],this}},{key:"_renderOrderSort",value:function(t,e){return t.renderOrder-e.renderOrder}}]),e}(l.default);f.default.addPlugin(0,p),r.default=p,e.exports=r.default},{"../Renderer":18,"../RendererPlugin":19,"../libConstants":30}],47:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("../shaders/multiSprite.frag.js"),l=n(s),c=t("../shaders/multiSprite.vert.js"),f=n(c),h=t("../ShaderProgram"),d=n(h),p=t("../RendererPlugin"),v=n(p),m=t("../Renderer"),y=n(m),b=t("../libConstants"),_=n(b),g=function(t){function e(t){i(this,e);var r=a(this,Object.getPrototypeOf(e).call(this));return r._renderer=t,r._shaderProgram=new d.default({vertex:f.default,fragment:l.default,uniforms:[{name:"uPCamera",type:"mat4"},{name:"uHalfSize",type:"2f"},{name:"uTexture",type:"1i"},{name:"uSmoothing",type:"1f"}],attributes:[{name:"disposition"},{name:"texture"},{name:"position"},{name:"colorAlpha"},{name:"scale"},{name:"offset"}]}),r.type=_.default.MULTI_SPRITE_RENDERER,r}return o(e,t),u(e,[{key:"render",value:function(t){var e=this._renderer.getSize(),r=t.gl,n=t.camera;return t.shaderProgram=this._shaderProgram,r.disable(r.DEPTH_TEST),r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),this._shaderProgram.enable(r).bind(r,{uPCamera:new Float32Array(n.modelViewMatrix),uHalfSize:[e[0]/2,e[1]/2],uTexture:0}),r.activeTexture(r.TEXTURE0),this._objects.forEach(function(e){return e.render(t)}),this._objects=[],this._shaderProgram.disable(r),this}}]),e}(v.default);y.default.addPlugin(30,g),r.default=g,e.exports=r.default},{"../Renderer":18,"../RendererPlugin":19,"../ShaderProgram":22,"../libConstants":30,"../shaders/multiSprite.frag.js":54,"../shaders/multiSprite.vert.js":55}],48:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("../shaders/sprite.frag.js"),l=n(s),c=t("../shaders/sprite.vert.js"),f=n(c),h=t("../ShaderProgram"),d=n(h),p=t("../RendererPlugin"),v=n(p),m=t("../Geometry"),y=n(m),b=t("../Renderer"),_=n(b),g=t("../Buffer"),M=n(g),E=t("../libConstants"),x=n(E),P=function(t){function e(){i(this,e);var t=a(this,Object.getPrototypeOf(e).call(this));return t._geometry=new y.default,t._geometry.setBuffer("position",new M.default(new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),3)).setBuffer("texture",new M.default(new Float32Array([0,0,1,0,1,1,0,1]),2)).setBuffer("index",new M.default(new Uint16Array([1,2,0,3,0,2]),1)),t._geometry.getBuffer("index").type=M.default.ElementArrayBuffer,t._shaderProgram=new d.default({vertex:f.default,fragment:l.default,uniforms:[{name:"uPCamera",type:"mat4"},{name:"uPosition",type:"3f"},{name:"uColorAlpha",type:"1f"},{name:"uScale",type:"2f"},{name:"uTexture",type:"1i"},{name:"uHalfSize",type:"2f"},{name:"uOffset",type:"2f"},{name:"uSmoothing",type:"1f"}],attributes:[{name:"position"},{name:"texture"},{name:"index",index:!0}]}),t.type=x.default.SPRITE_RENDERER,t}return o(e,t),u(e,[{key:"render",value:function(t){var e=t.gl,r=t.camera;return t.shaderProgram=this._shaderProgram,e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this._shaderProgram.enable(e).bind(e,{uPCamera:new Float32Array(r.modelViewMatrix),uTexture:0},{position:this._geometry.getBuffer("position"),texture:this._geometry.getBuffer("texture"),index:this._geometry.getBuffer("index")}),e.activeTexture(e.TEXTURE0),this._objects.forEach(function(e){return e.render(t)}),this._objects=[],this._shaderProgram.disable(e),this}}]),e}(v.default);_.default.addPlugin(20,P),r.default=P,e.exports=r.default},{"../Buffer":11,"../Geometry":12,"../Renderer":18,"../RendererPlugin":19,"../ShaderProgram":22,"../libConstants":30,"../shaders/sprite.frag.js":56,"../shaders/sprite.vert.js":57}],49:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("../RendererPlugin"),l=n(s),c=t("../Renderer"),f=n(c),h=t("../libConstants"),d=n(h),p=function(t){function e(){i(this,e);var t=a(this,Object.getPrototypeOf(e).call(this));return t.type=d.default.TRANSPARENT_RENDERER,t}return o(e,t),u(e,[{key:"render",value:function(t){var e=t.gl;return e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),t.renderer.sortObjects&&this._sortObjects(t),this._objects.forEach(function(e){return e.render(t)}),this._objects=[],this}},{key:"_sortObjects",value:function(t){var e=t.camera,r=this._reversePainterSortStable.bind(this,e);this._objects.sort(r)}},{key:"_reversePainterSortStable",value:function(t,e,r){if(e.renderOrder!==r.renderOrder)return e.renderOrder-r.renderOrder;var n=t.project(e.getWorldPosition())[2],i=t.project(r.getWorldPosition())[2];return i-n}}]),e}(l.default);f.default.addPlugin(10,p),r.default=p,e.exports=r.default},{"../Renderer":18,"../RendererPlugin":19,"../libConstants":30}],50:[function(t,e,r){"use strict";e.exports="\nprecision mediump float;\n\nuniform float uColorAlpha;\nvarying vec3 vColor;\n\nvoid main(void) {\n    gl_FragColor = vec4(vColor.rgb, uColorAlpha);\n}\n"},{}],51:[function(t,e,r){"use strict";e.exports="\nattribute vec3 position;\n\nuniform mat4 uPosition;\nuniform mat4 uCamera;\nuniform vec3 uColor;\nuniform vec3 uEmissive;\n\nvarying vec3 vColor;\n\nvoid main(void) {\n    vColor = uColor;\n\n    gl_Position = uCamera * uPosition * vec4(position, 1.0);\n}\n"},{}],52:[function(t,e,r){"use strict";e.exports="\nprecision mediump float;\n\n#ifdef USE_TEXTURE\n    uniform sampler2D uTexture;\n    varying vec2 vTextureCoord;\n    varying float vTextureEnable;\n#endif\n\nuniform float uColorAlpha;\nvarying vec3 vLightWeighting;\nvarying vec3 vColor;\nvarying vec3 vEmissive;\n\nvoid main(void) {\n    vec4 color = vec4(vColor.rgb, uColorAlpha);\n\n    #ifdef USE_TEXTURE\n        if (vTextureEnable > 0.5) {\n            vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n            color = vec4(textureColor.rgb * color.rgb, color.a);\n        }\n    #endif\n\n    gl_FragColor = vec4(color.rgb * vLightWeighting + vEmissive, color.a);\n}\n"},{}],53:[function(t,e,r){"use strict";e.exports="\nattribute vec3 position;\nattribute vec3 color;\nattribute vec3 emissive;\n\n#ifdef USE_TEXTURE\n    attribute vec2 texture;\n    attribute float textureEnable;\n    varying vec2 vTextureCoord;\n    varying float vTextureEnable;\n#endif\n\n#if DIR_LIGHT_NUM > 0\n    attribute vec3 normal;\n    uniform vec3 uDirectionLightColors[DIR_LIGHT_NUM];\n    uniform vec3 uDirectionLightPositions[DIR_LIGHT_NUM];\n    uniform mat3 uNormalMatrix;\n#endif\n\nuniform mat4 uPosition;\nuniform vec3 uAmbientLightColor;\nuniform mat4 uCamera;\n\nvarying vec3 vColor;\nvarying vec3 vEmissive;\nvarying vec3 vLightWeighting;\n\nvoid main(void) {\n    vColor = color;\n    vEmissive = emissive;\n\n    #ifdef USE_TEXTURE\n        vTextureCoord = texture;\n        vTextureEnable = textureEnable;\n    #endif\n\n    vec3 vLightTemp = vec3(0.0);\n\n    #if DIR_LIGHT_NUM > 0\n        vec3 transformedNormal = uNormalMatrix * normal;\n\n        for(int i = 0; i < DIR_LIGHT_NUM; i++) {\n            float dotProduct = dot(transformedNormal, uDirectionLightPositions[i]);\n            vec3 directionalLightWeighting = vec3(max(dotProduct, 0.0));\n            vLightTemp += uDirectionLightColors[i] * directionalLightWeighting;\n        }\n    #endif\n\n    vLightWeighting = uAmbientLightColor + vLightTemp;\n\n    gl_Position = uCamera * uPosition * vec4(position, 1.0);\n}\n"},{}],54:[function(t,e,r){"use strict";e.exports="\nprecision mediump float;\n\nuniform sampler2D uTexture;\n\nvarying vec2 vTextureCoord;\nvarying float vColorAlpha;\n\nvoid main(void) {\n    vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    gl_FragColor = textureColor * vColorAlpha;\n}\n"},{}],55:[function(t,e,r){"use strict";e.exports="\nattribute vec2 disposition;\nattribute vec2 texture;\n\nattribute vec3 position;\nattribute vec2 scale;\nattribute vec2 offset;\nattribute float colorAlpha;\n\nuniform float uSmoothing;\nuniform mat4 uPCamera;\nuniform vec2 uHalfSize;\n\nvarying vec2 vTextureCoord;\nvarying float vColorAlpha;\n\nvoid main(void) {\n    vTextureCoord = texture;\n    vColorAlpha = colorAlpha;\n\n    vec2 alignedPosition = disposition * scale;\n    alignedPosition += offset;\n    alignedPosition /= uHalfSize;\n\n    vec4 ndcPosition = uPCamera * vec4(position, 1.0);\n    ndcPosition.xyz = ndcPosition.xyz / ndcPosition.w;\n    ndcPosition.w = 1.0;\n    ndcPosition.xy += alignedPosition.xy;\n\n    vec2 roundedPosition = floor((ndcPosition.xy + 1.0) * uHalfSize.xy + 0.5) / uHalfSize.xy - 1.0;\n    vec2 roundingDelta = roundedPosition - ndcPosition.xy;\n\n    if (vColorAlpha == 0.0) {\n        ndcPosition.xy = vec2(-2.0, -2.0);\n    } else {\n        ndcPosition.xy = ndcPosition.xy + roundingDelta * uSmoothing;\n    }\n\n    gl_Position = ndcPosition;\n}\n"},{}],56:[function(t,e,r){"use strict";e.exports="\nprecision mediump float;\n\nuniform float uColorAlpha;\nuniform sampler2D uTexture;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vec4 textureColor = texture2D(uTexture, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    gl_FragColor = textureColor * uColorAlpha;\n}\n"},{}],57:[function(t,e,r){"use strict";e.exports="\nattribute vec2 position;\nattribute vec2 texture;\n\nuniform vec3 uPosition;\nuniform mat4 uPCamera;\nuniform vec2 uScale;\nuniform vec2 uHalfSize;\nuniform vec2 uOffset;\nuniform float uSmoothing;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vTextureCoord = texture;\n\n    vec2 alignedPosition = position * uScale;\n    alignedPosition += uOffset;\n    alignedPosition /= uHalfSize;\n\n    vec4 ndcPosition = uPCamera * vec4(uPosition, 1.0);\n    ndcPosition.xyz = ndcPosition.xyz / ndcPosition.w;\n    ndcPosition.w = 1.0;\n    ndcPosition.xy += alignedPosition.xy;\n\n    vec2 roundedPosition = floor((ndcPosition.xy + 1.0) * uHalfSize.xy + 0.5) / uHalfSize.xy - 1.0;\n    vec2 roundingDelta = roundedPosition - ndcPosition.xy;\n\n    ndcPosition.xy = ndcPosition.xy + roundingDelta * uSmoothing;\n\n    gl_Position = ndcPosition;\n}\n"},{}]},{},[29])(29)});
//# sourceMappingURL=dist/2gl.js.map